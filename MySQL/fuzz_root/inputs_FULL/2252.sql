drop table if exists t1,t2;
drop database if exists mysqltest;
create temporary table t1(n int not null primary key);
create table t2(n int);
insert into t2 values(3);
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
replace into t1 select n from t2;
flush tables;
reap;
reap;
select * from t1;
flush tables with read lock;
drop table t2;
drop table t2;
unlock tables;
reap;
create database mysqltest;
create table mysqltest.t1(n int);
insert into mysqltest.t1 values (23);
flush tables with read lock;
drop database mysqltest;
select * from mysqltest.t1;
unlock tables;
reap;
create table t1 (n int);
flush tables with read lock;
insert into t1 values (345);
select * from t1;
drop table t1;
create table t1 (c1 int);
lock table t1 write;
flush tables with read lock;
lock table t1 read;
flush tables with read lock;
unlock tables;
flush tables with read lock;
lock table t1 write;
lock table t1 read;
lock table t1 write;
unlock tables;
create table t2 (c1 int);
create table t3 (c1 int);
lock table t1 read, t2 read, t3 write;
flush tables with read lock;
lock table t1 read, t2 read, t3 read;
flush tables with read lock;
unlock tables;
drop table t1, t2, t3;
create table t1 (c1 int);
create table t2 (c1 int);
lock table t1 write;
flush tables with read lock;
insert into t2 values(1);
unlock tables;
reap;
reap;
drop table t1, t2;
drop table if exists t1, t2;
set session low_priority_updates=1;
create table t1 (a int);
create table t2 (b int);
lock tables t1 write;
flush tables with read lock;
unlock tables;
lock tables t1 read, t2 write;
flush tables with read lock;
unlock tables;
lock tables t1 read;
flush tables with read lock;
unlock tables;
drop table t1, t2;
set session low_priority_updates=default;
set @old_general_log= @@general_log;
set @old_read_only= @@read_only;
set global general_log= on;
flush tables with read lock;
flush logs;
unlock tables;
set global read_only=1;
flush logs;
unlock tables;
flush tables with read lock;
flush logs;
unlock tables;
set global general_log= @old_general_log;
set global read_only= @old_read_only;
drop tables if exists t1, t2;
create table t1 (i int);
create temporary table t2 (j int);
flush tables with read lock;
lock table t2 read;
commit;
unlock tables;
drop tables t1, t2;
flush tables with read lock, hosts;
flush privileges, tables;
flush privileges, tables with read lock;
flush privileges, tables;
flush tables with read lock, tables;
show tables;
drop table if exists t1, t2, t3;
create table t1 (a int);
create table t2 (a int);
create table t3 (a int);
lock table t1 read, t2 read;
flush tables with read lock;
unlock tables;
flush tables with read lock;
flush tables t1, t2 with read lock;
flush tables t1, t2 with read lock;
flush tables with read lock;
select * from t1;
select * from t2;
select * from t3;
insert into t1 (a) values (1);
insert into t2 (a) values (1);
insert into t3 (a) values (1);
lock table no_such_table read;
insert into t2 (a) values (1);
unlock tables;
insert into t1 (a) values (1);
insert into t2 (a) values (1);
flush table t1, t2 with read lock;
select * from t1;
select * from t2;
select * from t3;
insert into t1 (a) values (2);
insert into t2 (a) values (2);
insert into t3 (a) values (2);
lock table no_such_table read;
insert into t3 (a) values (2);
flush tables t1 with read lock;
select * from t1;
select * from t2;
insert into t2 (a) values (3);
unlock tables;
flush tables with read lock;
flush table t1 with read lock;
select * from t1;
unlock tables;
unlock tables;
flush table t1 with read lock;
flush table t2 with read lock;
unlock tables;
unlock tables;
set global read_only=1;
flush table t1 with read lock;
unlock tables;
set global read_only=0;
flush tables t1, t2 with read lock;
lock table t1 read, t2 read;
unlock tables;
unlock tables;
show session status;
drop table t1, t2, t3;
drop view if exists v1, v2, v3;
drop table if exists t1, v1;
create table t1 (a int);
create view v1 as select 1;
create view v2 as select * from t1;
create view v3 as select * from v2;
flush table v1, v2, v3 with read lock;
flush table v1 with read lock;
flush table v2 with read lock;
flush table v3 with read lock;
create temporary table v1 (a int);
flush table v1 with read lock;
drop view v1;
create table v1 (a int);
flush table v1 with read lock;
drop temporary table v1;
unlock tables;
drop view v2, v3;
drop table t1, v1;
drop table if exists t1;
create table t1 (a int, key a (a));
insert into t1 (a) values (1), (2), (3);
handler t1 open;
handler t1 read a next;
handler t1 read a next;
flush tables t1 with read lock;
handler t1 read a next;
unlock tables;
handler t1 read a next;
handler t1 close;
drop table t1;
drop table if exists t1;
create table t1 (a int);
begin;
select * from t1;
lock table t1 read;
flush table t1;
select * from t1;
select * from t1;
unlock tables;
reap;
reap;
commit;
begin;
select * from t1;
lock table t1 read;
flush tables;
select * from t1;
select * from t1;
unlock tables;
reap;
reap;
commit;
show session status;
show session status;
drop table t1;
drop table if exists t1, t2;
create table t1 (i int);
create table t2 (i int);
handler t1 open;
flush tables with read lock;
insert into t2 values (1);
reap;
unlock tables;
reap;
handler t1 close;
show session status;
show session status;
drop tables t1, t2;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT);
FLUSH TABLES t1 WITH READ LOCK;
FLUSH TABLES;
CREATE TRIGGER t1_bi BEFORE INSERT ON t1 FOR EACH ROW SET @a= 1;
ALTER TABLE t1 COMMENT 'test';
UNLOCK TABLES;
DROP TABLE t1;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT PRIMARY KEY, value INT);
INSERT INTO t1 VALUES (1, 1);
CREATE TRIGGER t1_au AFTER UPDATE ON t1 FOR EACH ROW SET @var = "a";
BEGIN;
UPDATE t1 SET value= value + 1 WHERE id = 1;
FLUSH TABLES WITH READ LOCK;
UNLOCK TABLES;
show session status;
COMMIT;
DROP TABLE t1;
