CREATE USER unlocked_user@localhost IDENTIFIED BY 'pas';
SELECT account_locked FROM mysql.user WHERE user='unlocked_user' and host = 'localhost';
SELECT CURRENT_USER();
UPDATE mysql.user SET account_locked='Y'   WHERE user='unlocked_user' and host = 'localhost';
SELECT CURRENT_USER();
FLUSH PRIVILEGES;
SELECT CURRENT_USER();
UPDATE mysql.user SET account_locked='y'   WHERE user='unlocked_user' and host = 'localhost';
FLUSH PRIVILEGES;
ALTER USER unlocked_user@localhost ACCOUNT UNLOCK;
SELECT account_locked FROM mysql.user WHERE user = 'unlocked_user' and host = 'localhost';
SELECT CURRENT_USER();
ALTER USER unlocked_user@localhost ACCOUNT LOCK;
SELECT account_locked FROM mysql.user WHERE user = 'unlocked_user' and host = 'localhost';
CREATE USER unlocked_user2@localhost IDENTIFIED BY 'pas';
SELECT CURRENT_USER();
ALTER USER unlocked_user@localhost, unlocked_user2@localhost ACCOUNT UNLOCK;
SELECT user, account_locked FROM mysql.user WHERE (user = 'unlocked_user' and host = 'localhost') or (user = 'unlocked_user2' and host = 'localhost') ORDER BY user;
SELECT CURRENT_USER();
SELECT CURRENT_USER();
SHOW CREATE USER unlocked_user@localhost;
ALTER USER unlocked_user@localhost ACCOUNT LOCK;
SHOW CREATE USER unlocked_user@localhost;
DROP USER unlocked_user@localhost;
DROP USER unlocked_user2@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pass';
SELECT CURRENT_USER();
DROP USER ''@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pass' ACCOUNT UNLOCK;
SELECT CURRENT_USER();
DROP USER ''@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pass' ACCOUNT LOCK;
DROP USER ''@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pass';
ALTER USER ''@localhost ACCOUNT LOCK;
DROP USER ''@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pass' ACCOUNT LOCK;
ALTER USER ''@localhost ACCOUNT UNLOCK;
SELECT CURRENT_USER();
DROP USER ''@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pass';
ALTER USER ''@localhost PASSWORD EXPIRE ACCOUNT LOCK;
DROP USER ''@localhost;
CREATE user ''@localhost IDENTIFIED BY 'pass';
CREATE USER 'unlocked_user'@localhost IDENTIFIED BY 'pass';
UPDATE mysql.user SET account_locked='Y'   WHERE user='unlocked_user' and host = 'localhost';
ALTER USER unlocked_user@localhost ACCOUNT LOCK;
DROP USER unlocked_user@localhost;
DROP USER ''@localhost;
CREATE USER u1@localhost IDENTIFIED BY 'pass';
CREATE USER u2@localhost IDENTIFIED BY 'pass';
GRANT ALL ON *.* TO u1@localhost;
CREATE TABLE mysql.t1(counter INT);
INSERT INTO mysql.t1 VALUES(0);
CREATE DEFINER = u1@localhost PROCEDURE mysql.p1() BEGIN UPDATE mysql.t1 SET counter = counter + 1; SELECT counter FROM mysql.t1; END;
CALL mysql.p1();
GRANT EXECUTE ON PROCEDURE mysql.p1 TO u2@localhost;
ALTER USER u1@localhost ACCOUNT LOCK;
SELECT CURRENT_USER();
CALL mysql.p1();
FLUSH STATUS;
CREATE USER 'u3'@'localhost' IDENTIFIED BY 'pass' ACCOUNT LOCK;
SHOW STATUS LIKE 'Locked_connects';
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
ALTER USER u3@localhost ACCOUNT LOCK;
ALTER USER u3@localhost ACCOUNT UNLOCK;
