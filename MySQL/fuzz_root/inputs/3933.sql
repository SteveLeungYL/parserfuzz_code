SET PERSIST event_scheduler=DISABLED;
SET PERSIST_ONLY event_scheduler=123.456;
SET PERSIST_ONLY event_scheduler=DISABLED;
RESET PERSIST event_scheduler;
CREATE DATABASE bug27374791;
USE bug27374791;
CREATE TABLE T( i int);
RESET MASTER;
BEGIN;
INSERT INTO T values (9);
SET PERSIST max_connections=31;
RESET PERSIST;
SET GLOBAL max_connections=DEFAULT;
DROP DATABASE bug27374791;
SELECT @@max_binlog_cache_size;
SET PERSIST max_binlog_cache_size= @@global.max_binlog_cache_size;
SELECT * FROM performance_schema.persisted_variables WHERE VARIABLE_NAME= 'max_binlog_cache_size';
SET PERSIST_ONLY max_binlog_cache_size= @@global.max_binlog_cache_size;
SELECT * FROM performance_schema.persisted_variables WHERE VARIABLE_NAME= 'max_binlog_cache_size';
SET @a=cast(@@max_binlog_cache_size as char);
SELECT @a;
RESET PERSIST;
SET GLOBAL max_binlog_cache_size= DEFAULT;
SELECT @@global.optimizer_trace_offset, @@global.activate_all_roles_on_login, @@global.auto_increment_increment, @@global.auto_increment_offset, @@global.binlog_error_action, @@global.binlog_format, @@global.cte_max_recursion_depth, @@global.eq_range_index_dive_limit, @@global.innodb_monitor_disable, @@global.histogram_generation_max_mem_size, @@global.innodb_max_dirty_pages_pct, @@global.init_connect, @@global.max_join_size;
SET PERSIST optimizer_trace_offset = default;
SET PERSIST activate_all_roles_on_login= ON;
SET PERSIST auto_increment_increment= 4, auto_increment_offset= 2;
SET PERSIST binlog_error_action= IGNORE_ERROR, binlog_format= ROW;
SET PERSIST cte_max_recursion_depth= 4294967295, eq_range_index_dive_limit= 4294967295;
SET PERSIST innodb_monitor_disable='latch';
SET PERSIST innodb_max_dirty_pages_pct= 97.3;
SET PERSIST init_connect='SET autocommit=0';
SET PERSIST max_join_size= 18446744073709551615;
SELECT @@global.optimizer_trace_offset, @@global.activate_all_roles_on_login, @@global.auto_increment_increment, @@global.auto_increment_offset, @@global.binlog_error_action, @@global.binlog_format, @@global.cte_max_recursion_depth, @@global.eq_range_index_dive_limit, @@global.innodb_monitor_disable, @@global.innodb_max_dirty_pages_pct, @@global.init_connect, @@global.max_join_size;
SELECT * FROM performance_schema.persisted_variables ORDER BY 1;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT @@global.optimizer_trace_offset, @@global.activate_all_roles_on_login, @@global.auto_increment_increment, @@global.auto_increment_offset, @@global.binlog_error_action, @@global.binlog_format, @@global.cte_max_recursion_depth, @@global.eq_range_index_dive_limit, @@global.innodb_monitor_disable, @@global.innodb_max_dirty_pages_pct, @@global.init_connect, @@global.max_join_size;
SELECT * FROM performance_schema.persisted_variables ORDER BY 1;
RESET PERSIST;
SET GLOBAL optimizer_trace_offset = default, activate_all_roles_on_login = default, auto_increment_increment = default, auto_increment_offset = default, binlog_error_action = default, binlog_format = default, cte_max_recursion_depth = default, eq_range_index_dive_limit = default, innodb_monitor_disable = default, innodb_max_dirty_pages_pct = default, init_connect = default, max_join_size = default;
SET PERSIST max_join_size= 10000000;
SET PERSIST init_connect='';
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT COUNT(DISTINCT MICROSECOND(set_time)) FROM performance_schema.variables_info WHERE variable_name IN ('max_join_size', 'init_connect');
SET GLOBAL max_join_size=DEFAULT, init_connect=DEFAULT;
RESET PERSIST;
SELECT @@global.binlog_cache_size;
SELECT @@global.collation_database;
SELECT @@global.optimizer_trace_offset;
SELECT @@global.optimizer_switch;
SELECT @@global.enforce_gtid_consistency;
SELECT @@global.sql_mode;
SET @@global.binlog_cache_size= 4096;
SET @@persist_only.binlog_cache_size= default, @@persist_only.collation_database= default, @@persist_only.optimizer_trace_offset= default, @@persist_only.optimizer_switch= default, @@persist_only.enforce_gtid_consistency= default, @@persist_only.sql_mode= default;
SELECT * FROM performance_schema.persisted_variables ORDER BY 1;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT @@global.binlog_cache_size;
SELECT @@global.collation_database;
SELECT @@global.optimizer_trace_offset;
SELECT @@global.optimizer_switch;
SELECT @@global.enforce_gtid_consistency;
SELECT @@global.sql_mode;
SELECT * FROM performance_schema.persisted_variables ORDER BY 1;
RESET PERSIST;
SET PERSIST mandatory_roles= default;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT * FROM performance_schema.persisted_variables ORDER BY 1;
RESET PERSIST;
CREATE DATABASE bug27903874;
USE bug27903874;
SET @@autocommit=FALSE;
CREATE TABLE t(a CHAR (1))ENGINE=InnoDB;
RESET PERSIST size;
SELECT JSON_OBJECTAGG(id,x) FROM t;
RESET SLAVE;
DROP DATABASE bug27903874;
SELECT @@global.innodb_tmpdir;
SET PERSIST innodb_tmpdir = default;
SELECT @@global.innodb_ft_user_stopword_table;
SET PERSIST innodb_ft_user_stopword_table = NULL;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT variable_name FROM performance_schema.variables_info WHERE variable_source='PERSISTED';
SELECT @@global.innodb_tmpdir, @@global.innodb_ft_user_stopword_table;
RESET PERSIST;
CREATE USER u1;
SET PERSIST_ONLY ft_query_expansion_limit=80, innodb_api_enable_mdl=1;
SET PERSIST sort_buffer_size=156000,max_connections= 52;
SET PERSIST max_heap_table_size=887808, replica_net_timeout=160;
SHOW GRANTS;
RESET PERSIST max_heap_table_size;
RESET PERSIST ft_query_expansion_limit;
RESET PERSIST;
GRANT SUPER ON *.* TO u1;
SHOW GRANTS;
RESET PERSIST max_heap_table_size;
RESET PERSIST ft_query_expansion_limit;
RESET PERSIST;
REVOKE SUPER ON *.* FROM u1;
GRANT SYSTEM_VARIABLES_ADMIN ON *.* TO u1;
SHOW GRANTS;
RESET PERSIST max_connections;
RESET PERSIST ft_query_expansion_limit;
RESET PERSIST;
REVOKE SYSTEM_VARIABLES_ADMIN ON *.* FROM u1;
GRANT PERSIST_RO_VARIABLES_ADMIN ON *.* TO u1;
SHOW GRANTS;
RESET PERSIST replica_net_timeout;
RESET PERSIST ft_query_expansion_limit;
RESET PERSIST;
GRANT SYSTEM_VARIABLES_ADMIN ON *.* TO u1;
SHOW GRANTS;
RESET PERSIST replica_net_timeout;
RESET PERSIST ft_query_expansion_limit;
RESET PERSIST;
SELECT * FROM performance_schema.persisted_variables;
SET GLOBAL sort_buffer_size = default, max_connections = default, replica_net_timeout = default, max_heap_table_size = default;
DROP USER u1;
SELECT @@global.innodb_strict_mode, @@global.innodb_lock_wait_timeout;
SELECT @@global.myisam_repair_threads, @@global.myisam_sort_buffer_size;
SELECT @@global.myisam_stats_method;
SET PERSIST innodb_strict_mode=0;
SET GLOBAL innodb_lock_wait_timeout = 150;
SELECT @@global.innodb_lock_wait_timeout;
SET PERSIST innodb_lock_wait_timeout = 110;
SELECT @@global.innodb_lock_wait_timeout;
SET GLOBAL myisam_repair_threads=27;
SET PERSIST myisam_repair_threads=12;
SET GLOBAL myisam_sort_buffer_size=16777216;
SET PERSIST myisam_sort_buffer_size=default;
SELECT @@global.innodb_lock_wait_timeout;
SET PERSIST myisam_stats_method=nulls_equal;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT @@global.innodb_strict_mode;
SELECT @@global.innodb_lock_wait_timeout;
SELECT @@global.myisam_repair_threads;
SELECT @@global.myisam_sort_buffer_size;
SELECT @@global.myisam_stats_method;
SELECT variable_name FROM performance_schema.variables_info WHERE variable_source='PERSISTED';
SET GLOBAL innodb_strict_mode=default, innodb_lock_wait_timeout=default, myisam_repair_threads=default, myisam_stats_method=default;
RESET PERSIST;
SET GLOBAL avoid_temporal_upgrade=TRUE;
SET PERSIST_ONLY avoid_temporal_upgrade=TRUE;
SET PERSIST avoid_temporal_upgrade=TRUE;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
RESET PERSIST;
SELECT @@global.skip_name_resolve;
CREATE USER 'bug28749668'@'%';
GRANT ALL ON *.* TO 'bug28749668'@'%';
SET PERSIST_ONLY skip_name_resolve=0;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT @@global.skip_name_resolve;
SELECT * FROM performance_schema.persisted_variables;
RESET PERSIST;
DROP USER 'bug28749668'@'%';
show session status;
SET PERSIST_ONLY replica_exec_mode = DEFAULT;
SELECT * FROM performance_schema.persisted_variables WHERE variable_name='replica_exec_mode';
RESET PERSIST;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE variable_name LIKE 'skip_%_start' ORDER BY 1;
SET PERSIST_ONLY skip_replica_start = ON;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE variable_name LIKE 'skip_%_start' ORDER BY 1;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE variable_name LIKE 'skip_%_start' ORDER BY 1;
RESET PERSIST;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
