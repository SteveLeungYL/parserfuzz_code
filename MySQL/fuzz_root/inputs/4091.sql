CREATE RESOURCE GROUP 'invalid_utf8¿ÿres' TYPE=USER VCPU=1-3, 1;
CREATE RESOURCE GROUP test TYPE=INVALID_TYPE VCPU=3-1, 0;
SHOW WARNINGS;
CREATE RESOURCE GROUP USER_resource TYPE=USER;
CREATE USER u1;
GRANT RESOURCE_GROUP_USER ON *.* TO u1;
DROP USER u1;
CREATE USER u1;
GRANT RESOURCE_GROUP_USER ON *.* TO u1;
DROP USER u1;
ALTER RESOURCE GROUP SYS_default VCPU=0;
ALTER RESOURCE GROUP USR_default VCPU=1;
CREATE USER u1;
GRANT RESOURCE_GROUP_USER ON *.* TO u1;
DROP USER u1;
DROP RESOURCE GROUP USR_default;
DROP RESOURCE GROUP SYS_default;
CREATE RESOURCE GROUP system_resource TYPE=SYSTEM VCPU=0-2 THREAD_PRIORITY=-1;
SET RESOURCE GROUP system_resource FOR 9;;
SELECT THREAD_ID, NAME, RESOURCE_GROUP FROM performance_schema.threads WHERE THREAD_ID=9;;
SET RESOURCE GROUP system_resource FOR 5, 3;;
SELECT COUNT(*) = 2 FROM performance_schema.threads WHERE THREAD_ID IN (5, 3);;
CREATE USER u1;
GRANT RESOURCE_GROUP_USER ON *.* TO u1;
SET RESOURCE GROUP system_resource;
DROP USER u1;
SET RESOURCE GROUP SYS_default;
SELECT /*+ RESOURCE_GROUP(rg) */ 1;
CREATE USER u1;
SELECT /*+ RESOURCE_GROUP(system_resource) */ 1;
DROP USER u1;
SELECT * FROM INFORMATION_SCHEMA.RESOURCE_GROUPS;
CREATE USER u1;
SELECT * FROM INFORMATION_SCHEMA.RESOURCE_GROUPS;
GRANT RESOURCE_GROUP_USER ON *.* TO u1;
SELECT * FROM INFORMATION_SCHEMA.RESOURCE_GROUPS;
GRANT RESOURCE_GROUP_ADMIN ON *.* TO u1;
SELECT * FROM INFORMATION_SCHEMA.RESOURCE_GROUPS;
DROP USER u1;
DROP RESOURCE GROUP system_resource FORCE;
CREATE FUNCTION func() RETURNS INT BEGIN CREATE RESOURCE GROUP Batch TYPE = USER VCPU = 2-3; RETURN 0; END;
CREATE RESOURCE GROUP Batch TYPE = USER VCPU = 2-3;
CREATE FUNCTION func() RETURNS INT BEGIN SET RESOURCE GROUP Batch; RETURN 0; END;
SELECT func();
SELECT COUNT(*) = 1 FROM performance_schema.threads WHERE RESOURCE_GROUP="Batch";
DROP RESOURCE GROUP Batch FORCE;
DROP FUNCTION func;
CREATE RESOURCE GROUP test TYPE = USER VCPU=2-3;
SET @rg_name='test';
SET @cmd = CONCAT("SET RESOURCE GROUP ", @rg_name);
SELECT @cmd;
PREPARE stmt FROM @cmd;
EXECUTE stmt;
SELECT COUNT(*) = 1 FROM performance_schema.threads WHERE RESOURCE_GROUP="test";
DROP RESOURCE GROUP test FORCE;
