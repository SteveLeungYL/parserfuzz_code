USE test;
RESET MASTER;
RESET REPLICA ALL FOR CHANNEL '';
USE test;
RESET MASTER;
RESET REPLICA ALL FOR CHANNEL '';
CHANGE REPLICATION SOURCE TO SOURCE_HOST = '127.0.0.1', SOURCE_PORT = 13000, SOURCE_USER = 'root', SOURCE_AUTO_POSITION = 0, PRIVILEGE_CHECKS_USER = NULL, REQUIRE_ROW_FORMAT = 0, GTID_ONLY = 0, SOURCE_CONNECT_RETRY = 1 FOR CHANNEL '';
START REPLICA ;
STOP REPLICA ;
CREATE USER 'plug_user' IDENTIFIED WITH 'test_plugin_server' AS 'plug_user';
GRANT REPLICATION SLAVE ON *.* TO plug_user;
FLUSH PRIVILEGES;
CHANGE REPLICATION SOURCE TO  SOURCE_USER=     'plug_user', SOURCE_PASSWORD= 'plug_user', SOURCE_RETRY_COUNT= 0;
START REPLICA ;
SELECT user, plugin, authentication_string FROM mysql.user WHERE user LIKE 'plug_user';
STOP REPLICA ;
CHANGE REPLICATION SOURCE TO SOURCE_USER='root';
DROP USER 'plug_user';
DROP USER 'plug_user';
SELECT asynchronous_connection_failover_reset();
SELECT asynchronous_connection_failover_reset();
KILL 15;
