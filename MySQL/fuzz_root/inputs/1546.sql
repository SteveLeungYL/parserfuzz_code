FLUSH STATUS;
SELECT USER();
SELECT USER();
SELECT USER();
FLUSH PRIVILEGES;
SELECT USER();
SELECT USER();
SHOW STATUS LIKE 'locked_connects';
FLUSH STATUS;
CREATE USER u1@localhost ACCOUNT LOCK;
ALTER USER u1@localhost;
CREATE USER u2@localhost IDENTIFIED BY 'auth_string' ACCOUNT LOCK;
SHOW CREATE USER u2@localhost;
DROP USER u2@localhost;
CREATE USER 'u2'@'localhost' IDENTIFIED WITH 'mysql_native_password'             AS '*67092806AE91BFB6BE72DE6C7BE2B7CCA8CFA9DF'             REQUIRE NONE PASSWORD EXPIRE DEFAULT ACCOUNT LOCK;
ALTER USER u2@localhost IDENTIFIED BY 'auth_string' ACCOUNT UNLOCK;
SELECT USER();
SHOW CREATE USER u2@localhost;
CREATE USER u3@localhost IDENTIFIED WITH 'sha256_password'                          ACCOUNT UNLOCK ACCOUNT LOCK;
SHOW CREATE USER u3@localhost;
ALTER USER u3@localhost IDENTIFIED WITH 'sha256_password'                         ACCOUNT LOCK ACCOUNT UNLOCK;
SELECT USER();
SET PASSWORD = 'def';
SHOW CREATE USER u3@localhost;
CREATE USER u4@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string'                          PASSWORD EXPIRE DEFAULT ACCOUNT LOCK;
ALTER USER u4@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string'                         ACCOUNT UNLOCK;
SHOW CREATE USER u4@localhost;
SELECT USER();
SELECT USER();
SELECT USER();
SELECT USER();
SELECT USER();
SELECT USER();
SET PASSWORD='auth_string';
SELECT USER();
CREATE USER u5@localhost REQUIRE SSL ACCOUNT LOCK PASSWORD EXPIRE;
SHOW CREATE USER u5@localhost;
ALTER USER u5@localhost REQUIRE SSL PASSWORD EXPIRE DEFAULT ACCOUNT UNLOCK;
SELECT USER();
CREATE USER u6@localhost IDENTIFIED BY 'auth_string' REQUIRE X509 ACCOUNT LOCK PASSWORD EXPIRE PASSWORD EXPIRE NEVER;
SHOW CREATE USER u6@localhost;
ALTER USER u6@localhost ACCOUNT UNLOCK;
SHOW CREATE USER u6@localhost;
SELECT USER();
CREATE USER u7@localhost IDENTIFIED WITH 'sha256_password'             REQUIRE CIPHER "DHE-RSA-AES256-SHA"             PASSWORD EXPIRE NEVER PASSWORD EXPIRE NEVER;
SHOW CREATE USER u7@localhost;
SELECT USER();
ALTER USER u7@localhost IDENTIFIED WITH 'mysql_native_password'                         PASSWORD EXPIRE DEFAULT ACCOUNT LOCK;
SHOW CREATE USER u7@localhost;
CREATE USER u8@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string'             REQUIRE ISSUER '/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=CA'             PASSWORD EXPIRE NEVER ACCOUNT UNLOCK;
SHOW CREATE USER u8@localhost;
SELECT USER();
ALTER USER u8@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string'             REQUIRE ISSUER '/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=CA'             PASSWORD EXPIRE NEVER ACCOUNT LOCK;
CREATE USER u9@localhost REQUIRE SUBJECT "/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=Client"             ACCOUNT LOCK PASSWORD EXPIRE NEVER;
ALTER USER u9@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string' ACCOUNT UNLOCK;
SHOW CREATE USER u9@localhost;
SELECT USER();
CREATE USER u10@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string#y'             REQUIRE CIPHER "DHE-RSA-AES256-SHA"             SUBJECT "/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=Client"             ISSUER "/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=CA"             ACCOUNT LOCK PASSWORD EXPIRE DEFAULT ACCOUNT UNLOCK;
SHOW CREATE USER u10@localhost;
SELECT USER();
ALTER USER u10@localhost REQUIRE CIPHER "DHE-RSA-AES256-SHA"            ACCOUNT UNLOCK PASSWORD EXPIRE DEFAULT ACCOUNT LOCK;
SHOW CREATE USER u10@localhost;
CREATE USER u11@localhost WITH MAX_QUERIES_PER_HOUR 2 ACCOUNT LOCK;
SHOW CREATE USER u11@localhost;
ALTER USER u11@localhost WITH MAX_QUERIES_PER_HOUR 6 ACCOUNT UNLOCK ACCOUNT UNLOCK;
SHOW CREATE USER u11@localhost;
DROP USER u11@localhost;
CREATE USER 'u11'@'localhost' IDENTIFIED WITH 'mysql_native_password' REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 6 PASSWORD EXPIRE DEFAULT ACCOUNT UNLOCK;
SELECT USER();
CREATE USER u12@localhost IDENTIFIED BY 'auth_string'                           WITH MAX_QUERIES_PER_HOUR 4 ACCOUNT LOCK PASSWORD EXPIRE NEVER PASSWORD EXPIRE ACCOUNT UNLOCK;
SHOW CREATE USER u12@localhost;
SELECT USER();
ALTER USER USER() IDENTIFIED BY 'abc';
SELECT USER();
ALTER USER u12@localhost ACCOUNT LOCK PASSWORD EXPIRE NEVER PASSWORD EXPIRE NEVER ACCOUNT UNLOCK ACCOUNT LOCK ACCOUNT LOCK ACCOUNT UNLOCK;
SHOW CREATE USER u12@localhost;
SELECT USER();
CREATE USER u13@localhost IDENTIFIED WITH 'sha256_password'             WITH MAX_CONNECTIONS_PER_HOUR 2 ACCOUNT LOCK;
ALTER USER u13@localhost PASSWORD EXPIRE INTERVAL 20 DAY ACCOUNT UNLOCK;
SHOW CREATE USER u13@localhost;
SELECT USER();
CREATE USER u14@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string' REQUIRE CIPHER "DHE-RSA-AES256-SHA" WITH MAX_USER_CONNECTIONS 2 ACCOUNT LOCK PASSWORD EXPIRE INTERVAL 999 DAY ACCOUNT UNLOCK;
SELECT USER();
ALTER USER u14@localhost REQUIRE SUBJECT "/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=Client" ISSUER "/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=CA" WITH MAX_USER_CONNECTIONS 2 ACCOUNT LOCK PASSWORD EXPIRE INTERVAL 999 DAY ACCOUNT UNLOCK;
SHOW CREATE USER u14@localhost;
SELECT USER();
CREATE USER u15@localhost, u16@localhost IDENTIFIED BY 'auth_string', u17@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string'             ACCOUNT UNLOCK;
SELECT USER();
SELECT USER();
SELECT USER();
CREATE USER u18@localhost, u19@localhost IDENTIFIED BY 'auth_string', u20@localhost IDENTIFIED WITH 'sha256_password', u21@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string', u22@localhost IDENTIFIED WITH 'mysql_native_password', u23@localhost IDENTIFIED WITH 'mysql_native_password'                           AS '*318C29553A414C4A571A077BC9E9A9F67D5E5634'             REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=Client'             WITH MAX_QUERIES_PER_HOUR 2 MAX_USER_CONNECTIONS 2 ACCOUNT LOCK;
ALTER  USER u18@localhost, u19@localhost IDENTIFIED BY 'auth_string', u20@localhost IDENTIFIED WITH 'sha256_password', u21@localhost IDENTIFIED WITH 'sha256_password' BY 'auth_string', u22@localhost IDENTIFIED WITH 'mysql_native_password', u23@localhost IDENTIFIED WITH 'mysql_native_password'                           AS '*318C29553A414C4A571A077BC9E9A9F67D5E5634'                           REQUIRE CIPHER "DHE-RSA-AES256-SHA"                           ISSUER "/C=SE/ST=Stockholm/L=Stockholm/O=Oracle/OU=MySQL/CN=CA"                           ACCOUNT UNLOCK;
SELECT USER();
SELECT USER();
SELECT USER();
SELECT USER();
SELECT USER();
SELECT USER();
SHOW STATUS LIKE 'Locked_connects';
SHOW GLOBAL STATUS LIKE 'LOCKED_Connects';
SHOW SESSION STATUS LIKE 'locked_connects';
FLUSH STATUS;
CREATE USER u1@localhost IDENTIFIED BY 'pass';
CREATE USER u2@localhost IDENTIFIED BY 'pass';
GRANT ALL ON *.* TO u1@localhost;
CREATE TABLE test.t1(counter INT);
INSERT INTO test.t1 VALUES(0);
CREATE TABLE test.t2(update_count INT);
CREATE DEFINER = u1@localhost TRIGGER test.t1_update_count BEFORE UPDATE ON test.t1 FOR EACH ROW BEGIN UPDATE test.t2 SET update_count = update_count + 1; END;
CREATE DEFINER = u1@localhost PROCEDURE test.p1() BEGIN UPDATE test.t1 SET counter= counter + 1; UPDATE test.t1 SET counter= counter + 1; UPDATE test.t1 SET counter= counter + 1; SELECT counter FROM test.t1; END;
CALL test.p1();
SELECT update_count FROM test.t2;
CREATE DEFINER = u1@localhost FUNCTION test.myfunc() RETURNS CHAR(50) BEGIN RETURN 'wl6054_test'; END;
GRANT EXECUTE ON PROCEDURE test.p1 TO u2@localhost;
GRANT EXECUTE ON FUNCTION test.myfunc TO u2@localhost;
ALTER USER u1@localhost ACCOUNT LOCK;
SELECT CURRENT_USER();
CALL test.p1();
SELECT update_count FROM test.t2;
SELECT update_count,myfunc() FROM test.t2;
DROP PROCEDURE IF EXISTS test.p1;
DROP TRIGGER IF EXISTS t1_update_count;
DROP FUNCTION IF EXISTS test.myfunc;
DROP TABLE test.t1,test.t2;
DROP USER u1@localhost,u2@localhost;
