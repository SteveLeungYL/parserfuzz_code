create function version_tokens_show returns string soname 'version_token.so';
SELECT version_tokens_show();
INSTALL PLUGIN version_tokens SONAME 'version_token.so';
UNINSTALL PLUGIN version_tokens;
INSTALL PLUGIN version_tokens SONAME 'version_token.so';
UNINSTALL PLUGIN version_tokens;
drop function version_tokens_show;
INSTALL PLUGIN version_tokens SONAME 'version_token.so';
create function version_tokens_set returns string soname 'version_token.so';
create function version_tokens_show returns string soname 'version_token.so';
create function version_tokens_edit returns string soname 'version_token.so';
create function version_tokens_delete returns string soname 'version_token.so';
create function version_tokens_lock_shared returns int soname 'version_token.so';
create function version_tokens_lock_exclusive returns int soname 'version_token.so';
create function version_tokens_unlock returns int soname 'version_token.so';
select version_tokens_set("token1    =     abc;token2=       def",123);
select version_tokens_edit("token1= 123;         token3     =         asdf",123);
select version_tokens_delete("token1;token3",123);
select version_tokens_show("123");
select version_tokens_set(123);
select version_tokens_edit(123);
select version_tokens_delete(123);
select version_tokens_lock_shared("Less arguments");
select version_tokens_lock_shared(1,"Wrong argument type");
select version_tokens_lock_exclusive("Less arguments");
select version_tokens_lock_exclusive(1,"Wrong argument type");
select version_tokens_unlock("Takes no arguments");
select version_tokens_lock_shared("gizmo", -1);
select version_tokens_lock_exclusive("gizmo", -1);
CREATE USER vbhagi@localhost;
select version_tokens_set("token1    =     abc;token2=       def");
select version_tokens_show();
select version_tokens_set("");
select version_tokens_show();
select version_tokens_set("token1    =     abc;token2=       def");
select version_tokens_show();
select version_tokens_edit("token1= 123;         token3     =         asdf");
select version_tokens_show();
do version_tokens_set("token1    =     def;;;;      ;invalid_token; token2= abc;;");
select version_tokens_show();
do version_tokens_set("token1    =     def;; token111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111=123;;      ;invalid_token; token2= abc;;");
select version_tokens_show();
do version_tokens_set("token1    =     none;;;;      ;invalid_token; token2= 123;;");
select version_tokens_show();
do version_tokens_set("token1=def;token2= abc;          ;token3=ghi");
select version_tokens_show();
select version_tokens_delete("invalid=token");
select version_tokens_show();
select version_tokens_delete("token1;token3");
select version_tokens_show();
select version_tokens_delete("*");
select version_tokens_show();
do version_tokens_set("token1=def;token2= abc;token3=111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111112");
select version_tokens_show();
select version_tokens_set("token1    =     abc;token2=       def");
select version_tokens_edit("token1= 123;         token3     =         asdf");
select version_tokens_delete("token1;token3");
select version_tokens_show();
set @@version_tokens_session= "token1=def";
select 1;
select 1;
set @@version_tokens_session= "token3=abc";
select 1;
show session status;
select @@version_tokens_session;
set @@version_tokens_session= "token111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111=abc;;";
show session status;
select @@version_tokens_session;
set @@version_tokens_session= ";;";
set @@version_tokens_session= NULL;
set @@version_tokens_session= "token1=def;;;;;;;;";
set @@version_tokens_session= "token1=def;;;      token2  =   abc    ;   =  ;;;;";
show session status;
set @@version_tokens_session= "token1=def;;;      token2  =   abc    ;  sdf =  ;;;;";
show session status;
set @@version_tokens_session= "token1=def;;        ;      token2  =   abc    ;;;;;";
use test;
create table t1 (c1 int);
drop table t1;
set @@version_tokens_session= "token1=def;;;      token2  =   abc    ;   = sdf ;;;;";
create table t1 (c1 int);
show session status;
set @@version_tokens_session= "token100=def;;;      token2  =   abc    ;;;;;";
create table t1 (c1 int);
select 1;
CREATE USER u1@localhost IDENTIFIED BY 'foo';
GRANT VERSION_TOKEN_ADMIN ON *.* TO u1@localhost;
SELECT version_tokens_set("a=aa;b=bb;c=cc");
set @@version_tokens_session= "a=aa";
SELECT sleep(6); # sleep for 6 seconds in background.;
SELECT version_tokens_lock_exclusive("b",20);
SELECT version_tokens_lock_exclusive("a",20);
SELECT version_tokens_unlock();
reap;
UNINSTALL PLUGIN version_tokens;
SELECT version_tokens_set("token1=abc;token2=def");
select version_tokens_set("token1    =     abc;token2=       def");
select version_tokens_edit("token1= 123;         token3     =         asdf");
select version_tokens_delete("token1;token3");
select version_tokens_show();
SHOW PRIVILEGES;
drop function version_tokens_set;
drop function version_tokens_show;
drop function version_tokens_edit;
drop function version_tokens_delete;
drop function version_tokens_lock_shared;
drop function version_tokens_lock_exclusive;
drop function version_tokens_unlock;
