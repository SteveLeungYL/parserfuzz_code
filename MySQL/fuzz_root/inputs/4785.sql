CREATE USER foo@localhost IDENTIFIED BY 'foo';
FLUSH PRIVILEGES;
DROP USER foo@localhost;
CREATE USER foo@localhost IDENTIFIED BY 'foo' FAILED_LOGIN_ATTEMPTS 4 PASSWORD_LOCK_TIME 6;
ALTER USER foo@localhost FAILED_LOGIN_ATTEMPTS 2;
ALTER USER foo@localhost PASSWORD_LOCK_TIME 3;
ALTER USER foo@localhost IDENTIFIED BY 'foo';
FLUSH PRIVILEGES;
ALTER USER foo@localhost ACCOUNT UNLOCK;
CREATE USER bar@localhost IDENTIFIED BY 'bar';
DROP USER foo@localhost;
DROP USER bar@localhost;
CREATE USER foo@localhost FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
SHOW CREATE USER foo@localhost;
CREATE USER failed_login_attempts@localhost FAILED_LOGIN_ATTEMPTS 2;
SHOW CREATE USER failed_login_attempts@localhost;
CREATE USER password_lock_time@localhost PASSWORD_LOCK_TIME 3;
SHOW CREATE USER password_lock_time@localhost;
DROP USER foo@localhost;
DROP USER foo@localhost, failed_login_attempts@localhost, password_lock_time@localhost;
CREATE USER foo@localhost IDENTIFIED BY 'foo' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
ALTER USER foo@localhost FAILED_LOGIN_ATTEMPTS 0;
SHOW CREATE USER foo@localhost;
ALTER USER foo@localhost FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 0;
SHOW CREATE USER foo@localhost;
DROP USER foo@localhost;
CREATE USER foo@localhost IDENTIFIED BY 'foo' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
ALTER USER foo@localhost FAILED_LOGIN_ATTEMPTS 2;
SHOW CREATE USER foo@localhost;
ALTER USER foo@localhost PASSWORD_LOCK_TIME 3;
SHOW CREATE USER foo@localhost;
DROP USER foo@localhost;
CREATE USER foo@localhost IDENTIFIED BY 'foo' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
DROP USER foo@localhost;
CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
SHOW CREATE USER foo@localhost;
FLUSH PRIVILEGES;
DROP USER foo@localhost;
CREATE USER foo@localhost IDENTIFIED BY 'foo' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3 ACCOUNT LOCK;
DROP USER foo@localhost;
SET GLOBAL check_proxy_users = ON;
SET GLOBAL mysql_native_password_proxy_users = ON;
CREATE USER proxied_to_user@localhost IDENTIFIED WITH 'mysql_native_password' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
CREATE USER proxy_user@localhost IDENTIFIED WITH 'mysql_native_password' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
GRANT PROXY ON proxied_to_user@localhost TO proxy_user@localhost;
SELECT USER(), CURRENT_USER(), @@session.proxy_user;
REVOKE PROXY ON proxied_to_user@localhost FROM proxy_user@localhost;
DROP USER proxied_to_user@localhost, proxy_user@localhost;
SET GLOBAL check_proxy_users = DEFAULT;
SET GLOBAL mysql_native_password_proxy_users = DEFAULT;
CREATE USER foo@localhost IDENTIFIED BY 'foo' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 2;
ALTER USER foo@localhost ACCOUNT UNLOCK;
DROP USER foo@localhost;
SET GLOBAL partial_revokes=1;
CREATE USER u1 identified by 'pwd';
GRANT CREATE ON *.* TO u1;
REVOKE CREATE ON mysql.* FROM u1;
ALTER USER u1 FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
ALTER USER u1 FAILED_LOGIN_ATTEMPTS 0 PASSWORD_LOCK_TIME 0;
DROP USER u1;
SET GLOBAL partial_revokes=DEFAULT;
CREATE USER foo@localhost FAILED_LOGIN_ATTEMPTS -1;
CREATE USER goo@localhost FAILED_LOGIN_ATTEMPTS 32768;
CREATE USER foo@localhost FAILED_LOGIN_ATTEMPTS 32767;
DROP USER foo@localhost;
CREATE USER foo@localhost PASSWORD_LOCK_TIME -1;
CREATE USER goo@localhost PASSWORD_LOCK_TIME 32768;
CREATE USER foo@localhost PASSWORD_LOCK_TIME 32767;
DROP USER foo@localhost;
CREATE USER ''@localhost IDENTIFIED BY 'pwd' FAILED_LOGIN_ATTEMPTS 2 PASSWORD_LOCK_TIME 3;
DROP USER ''@localhost;
CREATE USER foo@localhost IDENTIFIED BY 'foo' PASSWORD_LOCK_TIME 3 FAILED_LOGIN_ATTEMPTS 2;
ALTER USER foo@localhost ATTRIBUTE "{ \"test\": \"account locking\" }";
ALTER USER foo@localhost COMMENT "This is a test account for verifying that password locking and user attributes won't interfer with one and another.";
ALTER USER foo@localhost ACCOUNT UNLOCK;
DROP USER foo@localhost;
