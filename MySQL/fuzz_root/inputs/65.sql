CALL mtr.add_suppression("Failed to set up SSL because of the following *");
CALL mtr.add_suppression("One can only use the --user switch.*");
SET PERSIST auto_increment_increment=10;
SET @@persist.event_scheduler=0;
SET PERSIST replica_compressed_protocol=1;
SET GLOBAL PERSIST replica_compressed_protocol=1;
SET PERSIST @@global.replica_compressed_protocol=1;
SET PERSIST @@session.replica_compressed_protocol=1;
SET @@persist.@@replica_compressed_protocol=1;
SET SESSION auto_increment_increment=3;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_NAME = 'auto_increment_increment';
SET PERSIST innodb_checksum_algorithm=strict_crc32, PERSIST innodb_default_row_format=COMPACT, PERSIST sql_mode=ANSI_QUOTES,PERSIST innodb_fast_shutdown=0;
SET PERSIST innodb_flush_log_at_trx_commit=0,join_buffer_size=262144;
SET PERSIST innodb_thread_concurrency=32, PERSIST innodb_write_io_threads=32, PERSIST innodb_read_io_threads=invalid_val;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT @@global.innodb_fast_shutdown;
SELECT @@global.innodb_default_row_format;
SELECT @@global.sql_mode;
SELECT @@global.innodb_flush_log_at_trx_commit;
SELECT @@global.join_buffer_size;
SELECT @@global.innodb_checksum_algorithm;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_SOURCE = 'PERSISTED'   ORDER BY VARIABLE_NAME;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT @@global.innodb_fast_shutdown;
SELECT @@global.innodb_default_row_format;
SELECT @@global.sql_mode;
SELECT @@global.innodb_checksum_algorithm;
SELECT @@global.innodb_flush_log_at_trx_commit;
SELECT @@global.max_digest_length;
SELECT @@global.join_buffer_size;
SELECT @@global.sort_buffer_size;
SELECT VARIABLE_NAME,VARIABLE_SOURCE,MIN_VALUE,MAX_VALUE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('innodb_fast_shutdown','sql_mode', 'innodb_default_row_format','max_digest_length', 'innodb_flush_log_at_trx_commit', 'disconnect_on_expired_password', 'innodb_checksum_algorithm') ORDER BY VARIABLE_NAME;
reset master;
SET PERSIST max_connections=500;
SET PERSIST autocommit=OFF;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_NAME = 'max_connections';
SET GLOBAL max_connections=DEFAULT;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('max_connections','autocommit');
CREATE TABLE t1 (col1 INT);
DROP TABLE t1;
SET PERSIST log_bin_trust_function_creators=1;
SET PERSIST block_encryption_mode= 'aes-128-ecb';
SET PERSIST ft_boolean_syntax= '+ -><()~*:""&|', PERSIST log_error_services=DEFAULT;
SET PERSIST innodb_max_dirty_pages_pct=80.99;
SET PERSIST slow_query_log=ON;
SET PERSIST slow_query_log_file='/data/yu/Squirrel_DBMS_Fuzzing/MySQL_source/mysql-server-inst/bld/mysql-test/var/log/slow_query_on.log;';
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SET PERSIST slow_query_log_file=DEFAULT;
RESET PERSIST slow_query_log_file;
SET PERSIST slow_query_log=DEFAULT;
SELECT @@global.block_encryption_mode;
SELECT @@global.ft_boolean_syntax;
SELECT @@global.log_error_services;
SELECT @@global.innodb_max_dirty_pages_pct;
SELECT VARIABLE_NAME, VARIABLE_SOURCE, MIN_VALUE, MAX_VALUE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('block_encryption_mode', 'ft_boolean_syntax','log_error_services','innodb_max_dirty_pages_pct') ORDER BY VARIABLE_NAME;
SELECT @@global.innodb_fast_shutdown;
SELECT @@global.innodb_default_row_format;
SELECT @@global.sql_mode;
SELECT @@global.innodb_checksum_algorithm;
SELECT @@global.max_digest_length;
SELECT @@global.max_connections;
SELECT @@global.innodb_flush_log_at_trx_commit;
SELECT @@global.join_buffer_size;
SELECT @@global.innodb_flush_sync;
SELECT @@global.autocommit;
SELECT @@session.autocommit;
SELECT VARIABLE_NAME, VARIABLE_SOURCE, MIN_VALUE, MAX_VALUE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('innodb_fast_shutdown','sql_mode', 'innodb_default_row_format','max_digest_length','max_connections', 'innodb_flush_log_at_trx_commit','innodb_flush_sync', 'autocommit','innodb_checksum_algorithm') ORDER BY VARIABLE_NAME;
SELECT VARIABLE_NAME,VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_SOURCE = 'LOGIN';
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
TRUNCATE TABLE mysql.general_log;
SET @old_log_output=    @@global.log_output;
SET @old_general_log=         @@global.general_log;
SET @old_general_log_file=    @@global.general_log_file;
SET GLOBAL general_log_file = '/data/yu/Squirrel_DBMS_Fuzzing/MySQL_source/mysql-server-inst/bld/mysql-test/var/log/persist_general.log';
SET PERSIST log_output =       'FILE,TABLE';
SET PERSIST general_log=       'ON';
reset master;
SET PERSIST innodb_io_capacity=225;
SET PERSIST innodb_flush_sync=DEFAULT;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN('innodb_io_capacity','innodb_flush_sync');
SELECT argument FROM mysql.general_log WHERE argument LIKE 'SET PERSIST %';
SET PERSIST general_log_file = '/data/yu/Squirrel_DBMS_Fuzzing/MySQL_source/mysql-server-inst/bld/mysql-test/var/log/persist_general.log';
RESET PERSIST general_log_file;
SET PERSIST log_output=DEFAULT ,PERSIST general_log=DEFAULT;
SET GLOBAL general_log_file=  @old_general_log_file;
SET GLOBAL general_log=       @old_general_log;
SET GLOBAL log_output=        @old_log_output;
TRUNCATE TABLE mysql.general_log;
SET PERSIST block_encryption_mode=DEFAULT, PERSIST ft_boolean_syntax=DEFAULT, PERSIST innodb_checksum_algorithm=DEFAULT, PERSIST log_error_services=DEFAULT, PERSIST innodb_max_dirty_pages_pct=DEFAULT;
SET PERSIST innodb_fast_shutdown=DEFAULT,PERSIST innodb_default_row_format=DEFAULT, PERSIST sql_mode=DEFAULT,PERSIST innodb_flush_log_at_trx_commit=DEFAULT, PERSIST max_connections=default, PERSIST join_buffer_size=default, PERSIST innodb_flush_sync=DEFAULT,PERSIST innodb_io_capacity=DEFAULT, PERSIST log_bin_trust_function_creators=DEFAULT, PERSIST autocommit=DEFAULT;
show create table performance_schema.variables_info;
CREATE USER 'user1'@'localhost' IDENTIFIED BY 'pass1';
GRANT ALL ON *.* TO 'user1'@'localhost';
SET @@global.max_connections = 100;
SET @@persist.event_scheduler=DEFAULT;
SET PERSIST auto_increment_increment=10;
SET PERSIST innodb_checksum_algorithm=strict_crc32;
SELECT VARIABLE_NAME, VARIABLE_SOURCE, SET_USER, SET_HOST FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('max_connections','event_scheduler', 'auto_increment_increment','innodb_checksum_algorithm');
RESET PERSIST auto_increment_increment;
RESET PERSIST innodb_checksum_algorithm;
SELECT VARIABLE_NAME, VARIABLE_SOURCE, SET_USER, SET_HOST FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('auto_increment_increment', 'innodb_checksum_algorithm');
select @@global.max_connections into @saved_max_connections;
select @@global.autocommit into @saved_autocommit;
CREATE USER 'internal_proxied'@'%' IDENTIFIED BY 'proxy_password';
CREATE USER 'external_u1'@'%' IDENTIFIED WITH test_plugin_server AS 'internal_proxied';
CREATE USER 'external_u2'@'%' IDENTIFIED WITH test_plugin_server AS 'internal_proxied';
GRANT PROXY ON 'internal_proxied'@'%' TO 'external_u1'@'%','external_u2'@'%';
GRANT ALL ON *.* TO 'internal_proxied'@'%';
SET @@global.max_connections=50;
SET @@global.autocommit=1;
SELECT VARIABLE_NAME, SET_USER, SET_HOST, SET_TIME from performance_schema.variables_info where variable_name='max_connections' or variable_name='autocommit';
drop USER 'user1'@'localhost';
drop USER 'internal_proxied'@'%';
drop USER 'external_u1'@'%';
drop USER 'external_u2'@'%';
SET GLOBAL max_connections = @saved_max_connections;
SET GLOBAL autocommit = @saved_autocommit;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('sort_buffer_size', 'max_connections', 'max_digest_length', 'innodb_fast_shutdown', 'innodb_default_row_format', 'innodb_flush_log_at_trx_commit');
SELECT @@sort_buffer_size, @@max_connections, @@max_digest_length;
SELECT @@innodb_fast_shutdown, @@innodb_default_row_format, @@innodb_flush_log_at_trx_commit;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT VARIABLE_NAME, VARIABLE_SOURCE FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('sort_buffer_size', 'max_connections', 'max_digest_length', 'innodb_fast_shutdown', 'innodb_default_row_format', 'innodb_flush_log_at_trx_commit');
SELECT @@sort_buffer_size, @@max_connections, @@max_digest_length;
SELECT @@innodb_fast_shutdown, @@innodb_default_row_format, @@innodb_flush_log_at_trx_commit;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
set @a=repeat('A',2000);
SET PERSIST init_connect=@a;;
set @b=repeat('A',24000);
SET PERSIST init_connect=@b;;
SET GLOBAL init_connect=default;
RESET PERSIST;
RESET PERSIST;
CREATE USER bug25677422;
GRANT ALL ON *.* TO bug25677422;
SET PERSIST sort_buffer_size=256000;
SET PERSIST max_heap_table_size=999424, replica_net_timeout=124;
SET PERSIST_ONLY innodb_read_io_threads= 16;
SET PERSIST long_query_time= 8.3452;
SET PERSIST_ONLY innodb_log_file_size= 4194304, ft_query_expansion_limit= 80;
SELECT VARIABLE_NAME, VARIABLE_SOURCE, SET_USER FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('sort_buffer_size', 'max_heap_table_size', 'replica_net_timeout', 'long_query_time', 'innodb_read_io_threads', 'innodb_log_file_size', 'ft_query_expansion_limit');
SELECT VARIABLE_NAME, VARIABLE_SOURCE, SET_USER FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('sort_buffer_size', 'max_heap_table_size', 'replica_net_timeout', 'long_query_time', 'innodb_read_io_threads', 'innodb_log_file_size', 'ft_query_expansion_limit');
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT VARIABLE_NAME FROM performance_schema.variables_info WHERE VARIABLE_SOURCE = 'PERSISTED';
SELECT VARIABLE_NAME, VARIABLE_SOURCE, SET_USER FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('sort_buffer_size', 'max_heap_table_size', 'replica_net_timeout', 'long_query_time', 'innodb_read_io_threads', 'innodb_log_file_size', 'ft_query_expansion_limit');
SELECT VARIABLE_NAME, VARIABLE_SOURCE, SET_USER FROM performance_schema.variables_info WHERE VARIABLE_NAME IN ('sort_buffer_size', 'max_heap_table_size', 'replica_net_timeout', 'long_query_time', 'innodb_read_io_threads', 'innodb_log_file_size', 'ft_query_expansion_limit');
DROP USER bug25677422;
RESET PERSIST;
SET GLOBAL sort_buffer_size=DEFAULT, max_heap_table_size=DEFAULT, replica_net_timeout=DEFAULT, long_query_time=DEFAULT;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
show session status;
SELECT 'END OF TEST';
