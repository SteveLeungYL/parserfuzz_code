set names koi8r;
DROP DATABASE IF EXISTS mysqltest1;
CREATE DATABASE mysqltest1 DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_unicode_ci;
use mysqltest1;
CREATE TABLE t1(��� INT);
INSERT INTO t1 VALUES(1);
CREATE VIEW v1 AS SELECT '����' AS c1, ��� AS c2 FROM t1;
CREATE VIEW v2 AS SELECT _utf8'тест' as c1;
CREATE VIEW v3 AS SELECT _utf8'тест';
SHOW CREATE VIEW v1;
SHOW CREATE VIEW v2;
SHOW CREATE VIEW v3;
ALTER DATABASE mysqltest1 COLLATE cp866_general_ci;
SET @@character_set_client= cp1251;
SET @@character_set_results= cp1251;
SET @@collation_connection= cp1251_general_ci;
use mysqltest1;
set names koi8r;
SHOW CREATE VIEW v1;
SHOW CREATE VIEW v2;
SHOW CREATE VIEW v3;
DROP DATABASE mysqltest1;
SET @@character_set_client= cp1251;
SET @@character_set_results= cp1251;
SET @@collation_connection= cp1251_general_ci;
use mysqltest1;
set names koi8r;
SHOW CREATE VIEW v1;
SHOW CREATE VIEW v2;
SHOW CREATE VIEW v3;
use test;
DROP DATABASE mysqltest1;
DROP DATABASE IF EXISTS mysqltest1;
DROP DATABASE IF EXISTS mysqltest2;
CREATE DATABASE mysqltest1 DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_unicode_ci;
CREATE DATABASE mysqltest2 DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_unicode_ci;
use mysqltest1;
CREATE PROCEDURE p1( INOUT �����1 CHAR(10), OUT �����2 CHAR(10)) BEGIN DECLARE �����1 CHAR(10); SELECT COLLATION(�����1) AS c1, COLLATION(�����1) AS c2, COLLATION(�����2) AS c3; SELECT COLLATION('�����') AS c4, COLLATION(_koi8r    '�����') AS c5, COLLATION(_utf8 'текст') AS c6, @@collation_connection AS c7, @@character_set_client AS c8; SET �����1 = 'a'; SET �����2 = 'b'; END;
CREATE PROCEDURE p2( INOUT �����1 CHAR(10) CHARACTER SET utf8, OUT �����2 CHAR(10) CHARACTER SET utf8) BEGIN DECLARE �����1 CHAR(10) CHARACTER SET utf8; SELECT COLLATION(�����1) AS c1, COLLATION(�����1) AS c2, COLLATION(�����2) AS c3; SELECT COLLATION('�����') AS c4, COLLATION(_koi8r    '�����') AS c5, COLLATION(_utf8 'текст') AS c6, @@collation_connection AS c7, @@character_set_client AS c8; SET �����1 = 'a'; SET �����2 = 'b'; END;
CREATE PROCEDURE mysqltest2.p3( INOUT �����1 CHAR(10), OUT �����2 CHAR(10)) BEGIN DECLARE �����1 CHAR(10); SELECT COLLATION(�����1) AS c1, COLLATION(�����1) AS c2, COLLATION(�����2) AS c3; SELECT COLLATION('�����') AS c4, COLLATION(_koi8r    '�����') AS c5, COLLATION(_utf8 'текст') AS c6, @@collation_connection AS c7, @@character_set_client AS c8; SET �����1 = 'a'; SET �����2 = 'b'; END;
CREATE PROCEDURE mysqltest2.p4( INOUT �����1 CHAR(10) CHARACTER SET utf8, OUT �����2 CHAR(10) CHARACTER SET utf8) BEGIN DECLARE �����1 CHAR(10) CHARACTER SET utf8; SELECT COLLATION(�����1) AS c1, COLLATION(�����1) AS c2, COLLATION(�����2) AS c3; SELECT COLLATION('�����') AS c4, COLLATION(_koi8r    '�����') AS c5, COLLATION(_utf8 'текст') AS c6, @@collation_connection AS c7, @@character_set_client AS c8; SET �����1 = 'a'; SET �����2 = 'b'; END;
SHOW CREATE PROCEDURE p1;
SHOW CREATE PROCEDURE p2;
SHOW CREATE PROCEDURE mysqltest2.p3;
SHOW CREATE PROCEDURE mysqltest2.p4;
SHOW PROCEDURE STATUS LIKE 'p1';
SHOW PROCEDURE STATUS LIKE 'p2';
SHOW PROCEDURE STATUS LIKE 'p3';
SHOW PROCEDURE STATUS LIKE 'p4';
SET @a = '1';
SET @b = '2';
CALL p1(@a, @b);
CALL p2(@a, @b);
CALL mysqltest2.p3(@a, @b);
CALL mysqltest2.p4(@a, @b);
ALTER DATABASE mysqltest1 COLLATE cp866_general_ci;
ALTER DATABASE mysqltest2 COLLATE cp866_general_ci;
SET @@character_set_client= cp1251;
SET @@character_set_results= cp1251;
SET @@collation_connection= cp1251_general_ci;
CALL p1(@a, @b);
CALL p2(@a, @b);
