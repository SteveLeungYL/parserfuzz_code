call mtr.add_suppression(" In RENAME TABLE table `test`.`parent` is referenced in foreign key constraints which are not compatible with the new table definition.");
SET @saved_binlog_format= @@SESSION.binlog_format;
drop table if exists t_34455;
create table t_34455 ( a int not null, foreign key (a) references t3 (a) match full match partial);
create table t_34455 ( a int not null, foreign key (a) references t3 (a) on delete set default match full);
create table t_34455 ( a int not null, foreign key (a) references t3 (a) on update set default match full);
create table t_34455 ( a int not null, foreign key (a) references t3 (a) on delete set default on delete set default);
create table t_34455 ( a int not null, foreign key (a) references t3 (a) on update set default on update set default);
create table t_34455 (a int not null);
alter table t_34455 add foreign key (a) references t3 (a) match full match partial);
alter table t_34455 add foreign key (a) references t3 (a) on delete set default match full);
alter table t_34455 add foreign key (a) references t3 (a) on update set default match full);
alter table t_34455 add foreign key (a) references t3 (a) on delete set default on delete set default);
alter table t_34455 add foreign key (a) references t3 (a) on update set default on update set default);
drop table t_34455;
SET @@foreign_key_checks= 0;
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY (b) REFERENCES non(a));
ALTER TABLE t1 ADD FOREIGN KEY (b) REFERENCES non(a);
DROP TABLE t1;
CREATE TABLE t1(a INT PRIMARY KEY);
CREATE TABLE t2(a INT PRIMARY KEY, b INT, FOREIGN KEY (b) REFERENCES t1(a));
DROP TABLE t1;
DROP TABLE t2;
SET @@foreign_key_checks= 1;
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY (b) REFERENCES non(a));
CREATE TABLE t1(a INT PRIMARY KEY, b INT REFERENCES non(a));
SHOW CREATE TABLE t1;
ALTER TABLE t1 ADD FOREIGN KEY (b) REFERENCES non(a);
DROP TABLE t1;
CREATE TABLE t1(a INT PRIMARY KEY);
CREATE TABLE t2(a INT PRIMARY KEY, b INT, FOREIGN KEY (b) REFERENCES t1(a));
DROP TABLE t1;
DROP TABLE t2, t1;
SET @@foreign_key_checks= DEFAULT;
CREATE TABLE t1(a INT PRIMARY KEY);
CREATE TABLE t2(a INT PRIMARY KEY, b INT);
ALTER TABLE t2 ADD CONSTRAINT name567890123456789012345678901234567890123456789012345678901234 FOREIGN KEY name567890123456789012345678901234567890123456789012345678901234 (b) REFERENCES t1(a);
SHOW CREATE TABLE t2;
DROP TABLE t2;
CREATE TABLE t2(a INT PRIMARY KEY, b INT);
ALTER TABLE t2 ADD FOREIGN KEY name5678901234567890123456789012345678901234567890123456789012345 (b) REFERENCES t1(a);
ALTER TABLE t2 ADD CONSTRAINT name5678901234567890123456789012345678901234567890123456789012345 FOREIGN KEY (b) REFERENCES t1(a);
DROP TABLE t2;
CREATE TABLE t2(a INT PRIMARY KEY, b INT UNIQUE);
ALTER TABLE t2 ADD FOREIGN KEY name5678901234567890123456789012345678901234567890123456789012345 (b) REFERENCES t1(a);
ALTER TABLE t2 ADD CONSTRAINT name5678901234567890123456789012345678901234567890123456789012345 FOREIGN KEY (b) REFERENCES t1(a);
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY(b) REFERENCES name5678901234567890123456789012345678901234567890123456789012345.t2(a));
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY(b) REFERENCES name5678901234567890123456789012345678901234567890123456789012345(a));
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY(b) REFERENCES t2(name5678901234567890123456789012345678901234567890123456789012345));
SET @@foreign_key_checks= 0;
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY(b) REFERENCES name5678901234567890123456789012345678901234567890123456789012345.t2(a));
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY(b) REFERENCES name5678901234567890123456789012345678901234567890123456789012345(a));
CREATE TABLE t1(a INT PRIMARY KEY, b INT, FOREIGN KEY(b) REFERENCES t2(name5678901234567890123456789012345678901234567890123456789012345));
SET @@foreign_key_checks= DEFAULT;
SET @@foreign_key_checks= 1;
CREATE TABLE t1(c1 INT PRIMARY KEY);
CREATE TABLE t2(c1 INT, FOREIGN KEY (c1) REFERENCES t1(c1));
ALTER TABLE t2 RENAME TO t3;
SHOW CREATE TABLE t3;
INSERT INTO t3 VALUES(1);
