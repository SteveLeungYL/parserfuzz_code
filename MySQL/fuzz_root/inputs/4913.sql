set big_tables=0;
flush status;
create table t1(a int, b int, c int);
insert into t1 values(null,null,null),(2,3,4);
WITH qn AS (SELECT a FROM t1) SELECT 1 FROM dual;
WITH qn AS (SELECT a FROM t1), qn2 as (select b from t1) SELECT 1 FROM dual;
WITH qn AS (SELECT a FROM t1), qn as (select b from t1) SELECT 1 FROM qn;
WITH qn AS (SELECT b as a FROM t1) SELECT qn.a, qn2.a  FROM qn, qn as qn2;
WITH qn AS (SELECT b as a FROM t1), qn2 AS (SELECT c FROM t1 WHERE a IS NULL or a>0) SELECT qn.a, qn2.c  FROM qn, qn2;
WITH qn AS (SELECT 10*a as a FROM t1), qn2 AS (SELECT 3*a FROM qn) SELECT * from qn2;
WITH qn AS (SELECT a FROM t1), qn2 AS (SELECT a FROM qn) SELECT * from qn2;
WITH qn AS (SELECT b as a FROM t1), qn2 AS (SELECT a FROM qn WHERE a IS NULL or a>0) SELECT qn.a, qn2.a  FROM qn, qn2;
EXPLAIN WITH qn AS (SELECT b as a FROM t1), qn2 AS (SELECT a FROM qn WHERE a IS NULL or a>0) SELECT qn.a, qn2.a  FROM qn, qn2;
WITH qn2 AS (SELECT a FROM qn WHERE a IS NULL or a>0), qn AS (SELECT b as a FROM t1) SELECT qn2.a  FROM qn2;
with qn1 as (with qn3 as (select * from qn2) select * from qn3), qn2 as (select 1) select * from qn1;
with qn0 as (select 1), qn1 as (select * from qn0), qn2 as (select 1), qn3 as (select 1 from qn1, qn2) select 1 from qn3;
explain with qn as (select 1) select 2;
with qn as (select 1) select 2;
WITH qn2 AS (SELECT a FROM qn WHERE a IS NULL or a>0), qn AS (SELECT b as a FROM qn2) SELECT qn.a  FROM qn;
WITH qn AS (SELECT a FROM qn) SELECT qn.a FROM qn;
WITH qn1 AS (SELECT a FROM qn3), qn2 AS (SELECT a FROM qn1), qn3 AS (SELECT a FROM t1), qn4 AS (SELECT a FROM qn2) SELECT a FROM qn4;
with qn as (select * from t1) select (select max(a) from qn);
with qn as (with qn2 as (select "qn2" as a from t1) select "qn", a from qn2) select * from qn;
CREATE VIEW v AS WITH qn AS (SELECT 10*a as a FROM t1), qn2 AS (SELECT 3*a AS b FROM qn) SELECT * from qn2;
DROP VIEW v;
CREATE TABLE t2 WITH qn AS (SELECT 10*a as a FROM t1), qn2 AS (SELECT 3*a AS b FROM qn) SELECT * from qn2;
INSERT INTO t2 WITH qn AS (SELECT 10*a as a FROM t1), qn2 AS (SELECT 3*a AS b FROM qn) SELECT * from qn2;
DROP TABLE t2;
explain with qn as (select * from t1 limit 10) select (select max(a) from qn where a=0), (select min(b) from qn where b=3);
with qn as (select * from t1 limit 10) select (select max(a) from qn where a=0), (select min(b) from qn where b=3);
create table qn select "base";
with qn as (select "with") select * from qn;
WITH qn AS (select * from qn) select * from qn;
create view v as select * from qn;
with qn as (select "with") select * from v;
with qn as (select * from v) select * from qn;
drop table qn;
with qn as (select "with") select * from v;
with qn as (select * from v) select * from qn;
create table qn select "base" as a;
create function f() returns varchar(10) return (select * from qn);
with qn as (select "with") select f();
with qn as (select f()) select * from qn;
create temporary table qn select "tmp" as a;
with qn as (select "with") select * from qn;
drop function f;
drop view v;
with qn as (select "with") select * from (select "dt") as qn;
WITH qn AS (select "outer" as a) SELECT (WITH qn AS (SELECT "inner" as a) SELECT a from qn), qn.a FROM qn;
with test.qn as (select "with") select * from test.qn;
with qn as (select "with") select * from qn;
with qn as (select "with") select * from test.qn;
with qn as (select "with" as a) select a from qn;
with qn as (select "with" as a) select qn.a from qn;
with qn as (select "with" as a) select test.qn.a from qn;
with qn as (select "with" as a) select a from test.qn;
with qn as (select "with" as a) select qn.a from test.qn;
with qn as (select "with" as a) select test.qn.a from test.qn;
drop temporary table qn;
with qn as (select "with" as a) select a from test.qn;
with qn as (select "with" as a) select qn.a from test.qn;
with qn as (select "with" as a) select test.qn.a from test.qn;
