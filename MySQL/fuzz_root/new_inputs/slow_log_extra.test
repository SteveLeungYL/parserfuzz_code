  SET @save_sqlf=@@global.slow_query_log_file;
eval SET GLOBAL slow_query_log_file= '$MYSQL_TMP_DIR/my_extra_slow1.log';
SET timestamp=10;
SELECT unix_timestamp(), sleep(2);
   use strict;
   my $file= $ENV{'SLOW_LOG1'} or die("slow log not set");
   my $result=0;
   open(FILE, "$file") or die("Unable to open $file: $!");
   while (<FILE>) {     my $line = $_;
     $result++ if ($line =~ /SET timestamp=10;/);
     $result++ if ($line =~ /Start: 1970-01-01T00:00:10.000000Z /);
   }   close(FILE);
   if($result != 2) {     print "[ FAIL ] timestamp not found\n";
   }   else {     print "[ PASS ] timestamp found\n";
   }EOFSET @@global.slow_query_log_file=@save_sqlf;
SET @save_sqlf=@@global.slow_query_log_file;
eval SET GLOBAL slow_query_log_file= '$MYSQL_TMP_DIR/my_extra_slow2.log';
SET GLOBAL long_query_time=0;
connect (con,localhost,root,,);
DROP TABLE IF EXISTS islow;
CREATE TABLE islow(i INT) ENGINE=innodb;
INSERT INTO islow VALUES (1), (2), (3), (4), (5), (6), (7), (8);
SELECT * FROM islow;
SELECT * FROM islow;
SET GLOBAL slow_query_log=0;
connection default;
disconnect con;
SET GLOBAL long_query_time=1;
DROP TABLE islow;
open FILE, "$ENV{'SLOW_LOG2'}" or die;
my @lines = <FILE>;
foreach $line (@lines) {  if ($line =~ m/^# Query_time/) {    $line =~ s/Thread_id: \d* Errno:/Thread_id: 0 Errno:/;
    $line =~ m/(Rows_sent.*) Start.*/;
    print "$1\n";
  }EOFSET @@global.slow_query_log_file=@save_sqlf;
SET GLOBAL slow_query_log=1;
SET @save_sqlf=@@global.slow_query_log_file;
eval SET GLOBAL slow_query_log_file= '$MYSQL_TMP_DIR/my_extra_slow3.log';
SET long_query_time=0;
CREATE TABLE b(id INT NOT NULL AUTO_INCREMENT);
open FILE, "$ENV{'SLOW_LOG3'}" or die "Could not open tmp slow log file: $!";
while (<FILE>) {  if (/Errno: (\d+)/)  { print "# Found Errno: $1 in slow log\n"; }close (FILE);
EOFSET @@global.slow_query_log_file=@save_sqlf;
SET GLOBAL slow_query_log=1;
