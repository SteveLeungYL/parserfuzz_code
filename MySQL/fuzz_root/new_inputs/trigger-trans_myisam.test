  create table t1 (c int primary key) engine=innodb;
create table t2 (c int) engine=myisam;
create table t3 (c int) engine=myisam;
insert into t1 (c) values (1);
delimiter |;
create trigger trg_bug26141_ai after insert on t1for each rowbegin  insert into t2 (c) values (1);
  select release_lock("lock_bug26141_sync") into @a;
  select get_lock("lock_bug26141_wait", 1000) into @a;
end|create trigger trg_bug26141_au after update on t1for each rowbegin  insert into t3 (c) values (1);
end|delimiter ;|connection connection_aux;
select get_lock("lock_bug26141_wait", 0);
connection default;
select get_lock("lock_bug26141_sync", /* must not be priorly locked */ 0);
send insert into t1 (c) values (2);
connection connection_update;
select get_lock("lock_bug26141_sync", 1000);
update t1 set c=3 where c=1;
select release_lock("lock_bug26141_sync");
connection connection_aux;
select release_lock("lock_bug26141_wait");
connection default;
reap;
select * from t1;
select * from t2;
select * from t3;
drop table t1, t2, t3;
disconnect connection_update;
disconnect connection_aux;
  create table t1 (c int primary key) engine=innodb;
create table t2 (c int) engine=myisam;
create table t3 (c int) engine=myisam;
insert into t1 (c) values (1);
delimiter |;
create trigger trg_bug26141_ai after insert on t1for each rowbegin  insert into t2 (c) values (1);
  select release_lock("lock_bug26141_sync") into @a;
  select get_lock("lock_bug26141_wait", 1000) into @a;
end|create trigger trg_bug26141_au after update on t1for each rowbegin  insert into t3 (c) values (1);
end|delimiter ;|connection connection_aux;
select get_lock("lock_bug26141_wait", 0);
connection default;
select get_lock("lock_bug26141_sync", /* must not be priorly locked */ 0);
send insert into t1 (c) values (2);
connection connection_update;
select get_lock("lock_bug26141_sync", 1000);
update t1 set c=3 where c=1;
select release_lock("lock_bug26141_sync");
connection connection_aux;
select release_lock("lock_bug26141_wait");
connection default;
reap;
select * from t1;
select * from t2;
select * from t3;
drop table t1, t2, t3;
disconnect connection_update;
disconnect connection_aux;
  create table t1 (c int primary key) engine=innodb;
create table t2 (c int) engine=myisam;
create table t3 (c int) engine=myisam;
insert into t1 (c) values (1);
delimiter |;
create trigger trg_bug26141_ai after insert on t1for each rowbegin  insert into t2 (c) values (1);
  select release_lock("lock_bug26141_sync") into @a;
  select get_lock("lock_bug26141_wait", 1000) into @a;
end|create trigger trg_bug26141_au after update on t1for each rowbegin  insert into t3 (c) values (1);
end|delimiter ;|connection connection_aux;
select get_lock("lock_bug26141_wait", 0);
connection default;
select get_lock("lock_bug26141_sync", /* must not be priorly locked */ 0);
send insert into t1 (c) values (2);
connection connection_update;
select get_lock("lock_bug26141_sync", 1000);
update t1 set c=3 where c=1;
select release_lock("lock_bug26141_sync");
connection connection_aux;
select release_lock("lock_bug26141_wait");
connection default;
reap;
select * from t1;
select * from t2;
select * from t3;
drop table t1, t2, t3;
disconnect connection_update;
disconnect connection_aux;
  create table t1 (c int primary key) engine=innodb;
create table t2 (c int) engine=myisam;
create table t3 (c int) engine=myisam;
insert into t1 (c) values (1);
delimiter |;
create trigger trg_bug26141_ai after insert on t1for each rowbegin  insert into t2 (c) values (1);
  select release_lock("lock_bug26141_sync") into @a;
  select get_lock("lock_bug26141_wait", 1000) into @a;
end|create trigger trg_bug26141_au after update on t1for each rowbegin  insert into t3 (c) values (1);
end|delimiter ;|connection connection_aux;
select get_lock("lock_bug26141_wait", 0);
connection default;
select get_lock("lock_bug26141_sync", /* must not be priorly locked */ 0);
send insert into t1 (c) values (2);
connection connection_update;
select get_lock("lock_bug26141_sync", 1000);
update t1 set c=3 where c=1;
select release_lock("lock_bug26141_sync");
connection connection_aux;
select release_lock("lock_bug26141_wait");
connection default;
reap;
select * from t1;
select * from t2;
select * from t3;
drop table t1, t2, t3;
disconnect connection_update;
disconnect connection_aux;
  create table t1 (c int primary key) engine=innodb;
create table t2 (c int) engine=myisam;
create table t3 (c int) engine=myisam;
insert into t1 (c) values (1);
delimiter |;
create trigger trg_bug26141_ai after insert on t1for each rowbegin  insert into t2 (c) values (1);
  select release_lock("lock_bug26141_sync") into @a;
  select get_lock("lock_bug26141_wait", 1000) into @a;
end|create trigger trg_bug26141_au after update on t1for each rowbegin  insert into t3 (c) values (1);
end|delimiter ;|connection connection_aux;
select get_lock("lock_bug26141_wait", 0);
connection default;
select get_lock("lock_bug26141_sync", /* must not be priorly locked */ 0);
send insert into t1 (c) values (2);
connection connection_update;
select get_lock("lock_bug26141_sync", 1000);
update t1 set c=3 where c=1;
select release_lock("lock_bug26141_sync");
connection connection_aux;
select release_lock("lock_bug26141_wait");
connection default;
reap;
select * from t1;
select * from t2;
select * from t3;
drop table t1, t2, t3;
disconnect connection_update;
disconnect connection_aux;
