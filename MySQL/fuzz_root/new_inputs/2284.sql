SET SESSION block_encryption_mode='aes-128-cfb8';
SET @IVA=REPEAT('a', 16);
SET @IVB=REPEAT('b', 16);
SET @KEY1=REPEAT('c', 16);
SET @KEY2=REPEAT('d', 16);
SET SESSION block_encryption_mode="aes-128-cfb8";
SELECT AES_ENCRYPT('a', @KEY1);
SELECT LENGTH(AES_ENCRYPT('a', @KEY1, @IVA));
SELECT TO_BASE64(AES_ENCRYPT('a', @KEY1, @IVA));
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a', @KEY1, @IVA), @KEY1, @IVA);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY1, @IVB);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY2, @IVA);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('b',@KEY1, @IVA), @KEY1, @IVA);
SET SESSION block_encryption_mode="aes-192-cfb8";
SELECT AES_ENCRYPT('a', @KEY1);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY1, @IVA);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY1, @IVB);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY2, @IVA);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('b',@KEY1, @IVA), @KEY1, @IVA);
SET SESSION block_encryption_mode="aes-256-cfb8";
SELECT AES_ENCRYPT('a', @KEY1);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY1, @IVA);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY1, @IVB);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('a',@KEY1, @IVA), @KEY2, @IVA);
SELECT 'a' = AES_DECRYPT(AES_ENCRYPT('b',@KEY1, @IVA), @KEY1, @IVA);
SET SESSION block_encryption_mode=DEFAULT;
CREATE TABLE aes_cfb8(a VARBINARY(128), b128 VARBINARY(144), b192 VARBINARY(144), b256 BINARY(144));
INSERT INTO aes_cfb8 (a) VALUES (REPEAT('a', 128));
INSERT INTO aes_cfb8 (a) VALUES (REPEAT(0x00313233, 32));
SET SESSION block_encryption_mode="aes-128-cfb8";
UPDATE aes_cfb8 SET b128 = AES_ENCRYPT(a, @KEY1, @IVA);
SET SESSION block_encryption_mode="aes-192-cfb8";
UPDATE aes_cfb8 SET b192 = AES_ENCRYPT(a, @KEY1, @IVA);
SET SESSION block_encryption_mode="aes-256-cfb8";
UPDATE aes_cfb8 SET b256 = AES_ENCRYPT(a, @KEY1, @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE b128 = b192 OR B192 = b256 OR b128=b256;
SET SESSION block_encryption_mode="aes-256-cfb8";
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b256, @KEY1, @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b256, 'b', @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b256, @KEY1, @IVB);
SET SESSION block_encryption_mode="aes-192-cfb8";
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b192, @KEY1, @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b192, @KEY2, @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b256, @KEY1, @IVB);
SET SESSION block_encryption_mode="aes-128-cfb8";
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b128, @KEY1, @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b128, @KEY2, @IVA);
SELECT COUNT(*) FROM aes_cfb8 WHERE a = AES_DECRYPT(b256, @KEY2, @IVB);
SET SESSION block_encryption_mode=DEFAULT;
DROP TABLE aes_cfb8;
SET SESSION block_encryption_mode=default;
