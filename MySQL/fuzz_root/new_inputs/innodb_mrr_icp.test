  if (!$BIG_TEST)  {      }connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
COMMIT;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SELECT @@transaction_isolation;
START TRANSACTION;
EXPLAIN SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
connection con2;
SET AUTOCOMMIT=0;
START TRANSACTION;
INSERT INTO t1 VALUES (2,2,2);
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
connection default;
disconnect con1;
disconnect con2;
connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
COMMIT;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
connection con2;
SET AUTOCOMMIT=0;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
COMMIT;
connection default;
disconnect con1;
disconnect con2;
set optimizer_switch='index_condition_pushdown=on,mrr=on,mrr_cost_based=off';
  set optimizer_switch='semijoin=off';
  set optimizer_switch='materialization=off';
set @save_storage_engine= @@default_storage_engine;
set default_storage_engine=InnoDB;
set default_storage_engine= @save_storage_engine;
set optimizer_switch=default;
  if (!$BIG_TEST)  {      }connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
COMMIT;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SELECT @@transaction_isolation;
START TRANSACTION;
EXPLAIN SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
connection con2;
SET AUTOCOMMIT=0;
START TRANSACTION;
INSERT INTO t1 VALUES (2,2,2);
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
connection default;
disconnect con1;
disconnect con2;
connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
COMMIT;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
connection con2;
SET AUTOCOMMIT=0;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
COMMIT;
connection default;
disconnect con1;
disconnect con2;
set optimizer_switch='index_condition_pushdown=on,mrr=on,mrr_cost_based=off';
  set optimizer_switch='semijoin=off';
  set optimizer_switch='materialization=off';
set @save_storage_engine= @@default_storage_engine;
set default_storage_engine=InnoDB;
set default_storage_engine= @save_storage_engine;
set optimizer_switch=default;
  if (!$BIG_TEST)  {      }connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
COMMIT;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SELECT @@transaction_isolation;
START TRANSACTION;
EXPLAIN SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
connection con2;
SET AUTOCOMMIT=0;
START TRANSACTION;
INSERT INTO t1 VALUES (2,2,2);
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
connection default;
disconnect con1;
disconnect con2;
connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
COMMIT;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
connection con2;
SET AUTOCOMMIT=0;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
COMMIT;
connection default;
disconnect con1;
disconnect con2;
set optimizer_switch='index_condition_pushdown=on,mrr=on,mrr_cost_based=off';
  set optimizer_switch='semijoin=off';
  set optimizer_switch='materialization=off';
set @save_storage_engine= @@default_storage_engine;
set default_storage_engine=InnoDB;
set default_storage_engine= @save_storage_engine;
set optimizer_switch=default;
  if (!$BIG_TEST)  {      }connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
COMMIT;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SELECT @@transaction_isolation;
START TRANSACTION;
EXPLAIN SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
connection con2;
SET AUTOCOMMIT=0;
START TRANSACTION;
INSERT INTO t1 VALUES (2,2,2);
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
connection default;
disconnect con1;
disconnect con2;
connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
COMMIT;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
connection con2;
SET AUTOCOMMIT=0;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
COMMIT;
connection default;
disconnect con1;
disconnect con2;
set optimizer_switch='index_condition_pushdown=on,mrr=on,mrr_cost_based=off';
  set optimizer_switch='semijoin=off';
  set optimizer_switch='materialization=off';
set @save_storage_engine= @@default_storage_engine;
set default_storage_engine=InnoDB;
set default_storage_engine= @save_storage_engine;
set optimizer_switch=default;
  if (!$BIG_TEST)  {      }connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
COMMIT;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SELECT @@transaction_isolation;
START TRANSACTION;
EXPLAIN SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
connection con2;
SET AUTOCOMMIT=0;
START TRANSACTION;
INSERT INTO t1 VALUES (2,2,2);
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
connection default;
disconnect con1;
disconnect con2;
connect (con1,localhost,root,,);
connect (con2,localhost,root,,);
connection con1;
SET AUTOCOMMIT=0;
CREATE TABLE t1 (  dummy INT PRIMARY KEY,  a INT UNIQUE,  b INT) ENGINE=InnoDB;
COMMIT;
INSERT INTO t1 VALUES (1,1,1),(3,3,3),(5,5,5);
connection con2;
SET AUTOCOMMIT=0;
SELECT * FROM t1 WHERE a > 2 FOR UPDATE;
ROLLBACK;
connection con1;
ROLLBACK;
DROP TABLE t1;
COMMIT;
connection default;
disconnect con1;
disconnect con2;
set optimizer_switch='index_condition_pushdown=on,mrr=on,mrr_cost_based=off';
  set optimizer_switch='semijoin=off';
  set optimizer_switch='materialization=off';
set @save_storage_engine= @@default_storage_engine;
set default_storage_engine=InnoDB;
set default_storage_engine= @save_storage_engine;
set optimizer_switch=default;
